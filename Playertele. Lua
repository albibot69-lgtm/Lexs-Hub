local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer

local function GetPlayerList()
    local list = {}
    for _, plr in ipairs(Players:GetPlayers()) do
        if plr ~= LocalPlayer then
            table.insert(list, plr.Name)
        end
    end
    return list
end

local SelectedPlayer = nil

local Dropdown = Tab6:Dropdown({
    Title = "Teleport Target",
    Values = GetPlayerList(),
    Value = GetPlayerList()[1],
    Callback = function(option)
        SelectedPlayer = option
    end
})

local TPButton = Tab6:Button({
    Title = "Teleport to Player",
    Locked = false,
    Callback = function()
        if not SelectedPlayer then
            warn("Belum pilih player!")
            return
        end

        local target = Players:FindFirstChild(SelectedPlayer)
        if target and target.Character and target.Character:FindFirstChild("HumanoidRootPart") then
            LocalPlayer.Character.HumanoidRootPart.CFrame =
                target.Character.HumanoidRootPart.CFrame + Vector3.new(0, 3, 0)
        else
            warn("Player tidak valid atau tidak ada!")
        end
    end
})

local RefreshButton = Tab6:Button({
    Title = "Refresh Player List",
    Locked = false,
    Callback = function()
        local newList = GetPlayerList()
        local success = false
        
        -- Update dropdown
        if Dropdown.SetValues then
            Dropdown:SetValues(newList)
            success = true
        elseif Dropdown.Refresh then
            Dropdown:Refresh(newList)
            success = true
        elseif Dropdown.Update then
            Dropdown:Update(newList)
            success = true
        else
            warn("Function update dropdown tidak ditemukan!")
        end
        
        -- Set ulang ke player pertama kalau ada
        if newList[1] then
            SelectedPlayer = newList[1]
            if Dropdown.Set then
                Dropdown:Set(newList[1])
            end
        end

        -- Notifikasi + print status refresh
        if success then
            print("✓ Player successfully refreshed (" .. #newList .. " player found)")
            WindUI:Notify({
                Title = "Refresh Successful!",
                Content = tostring(#newList) .. " player found",
                Duration = 3,
                Icon = "check"
            })
        else
            print("✗ Failed to refresh player list")
            WindUI:Notify({
                Title = "Refresh Failed",
                Content = "Unable to update player list",
                Duration = 3,
                Icon = "x"
            })
        end
    end
})
